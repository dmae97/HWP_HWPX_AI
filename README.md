# HWP & HWPX 파일 분석기

HWP & HWPX 파일 분석기는 한글(HWP) 및 한글 XML(HWPX) 파일을 분석하여 문서 구조, 내용, 메타데이터를 빠르게 이해하고 활용할 수 있는 강력한 도구입니다. Gemini API와 Perplexity API를 하이브리드로 활용하여 다양한 문서 타입(국책과제, 법률, 논문)에 대한 분석, 변환 및 고급 질의응답 기능을 제공합니다.

## 주요 기능

### 기본 기능
- **다중 한글 파일 처리**: 여러 HWP 및 HWPX 파일을 동시에 업로드하고 분석할 수 있습니다.
- **문서 구조 분석**: 문서의 섹션, 단락, 표, 이미지 등 구조적 요소를 분석합니다.
- **메타데이터 추출**: 문서의 제목, 작성자, 작성일, 수정일 등 메타데이터를 추출합니다.
- **텍스트 추출 및 분석**: 문서 내 텍스트를 추출하고 내용을 분석합니다.
- **표 추출 및 변환**: 문서 내 표를 추출하여 CSV, Excel 등으로 변환할 수 있습니다.
- **이미지 추출**: 문서에 포함된 이미지를 추출하여 저장할 수 있습니다.

### 고급 분석 기능
- **문서 타입 자동 감지**: 국책과제, 법률 문서, 학술 논문 등 문서 타입을 자동으로 감지하여 맞춤형 분석을 제공합니다.
- **한국어 자연어 처리 최적화**: 한국어에 특화된 텍스트 처리 기능으로 더 정확한 분석 결과를 제공합니다.
- **하이브리드 검색**: Perplexity API를 활용한 웹 검색으로 최신 정보를 포함한 분석 결과를 제공합니다.
- **API 캐싱 시스템**: API 응답을 캐싱하여 중복 요청을 줄이고 처리 속도를 향상시킵니다.
- **병렬 처리**: 대용량 문서도 병렬 처리를 통해 빠르게 분석합니다.
- **데이터 기반 성능 최적화**: 자체 성능 메트릭 시스템으로 API 호출 및 처리 성능을 모니터링합니다.

### 변환 및 활용 기능
- **문서 비교**: 여러 HWP/HWPX 문서를 비교하여 차이점과 유사점을 분석합니다.
- **LaTeX 변환**: HWP/HWPX 파일을 LaTeX 형식으로 변환하여 학술 논문이나 보고서 작성에 활용할 수 있습니다.
- **마크다운 변환**: HWP/HWPX 파일을 마크다운 형식으로 변환할 수 있습니다.
- **심층 분석 및 질의응답**: 분석된 문서에 대해 자연어로 질문하고 답변을 받을 수 있습니다.
- **최신성 평가**: 문서의 내용이 최신 정보를 반영하는지 평가하고 업데이트가 필요한 부분을 제안합니다.

## 지원하는 문서 타입

- **국책과제**: 정부 지원 사업, 연구개발 계획, 예산 및 성과 관련 문서
- **법률 문서**: 법률문서, 계약서, 판결문 등 법적 문서
- **학술 논문**: 학술 논문, 연구 보고서 등 학술 문서

## 설치 방법

1. 저장소 클론:
   ```
   git clone https://github.com/dmae97/HWP_HWPX_AI.git
   cd HWP_HWPX_AI
   ```

2. 가상환경 설정 및 패키지 설치:
   - Windows:
     ```
     install_packages.bat
     ```
   - Linux/Mac:
     ```
     chmod +x install_packages.sh
     ./install_packages.sh
     ```
   - 또는 수동으로 설정:
     ```
     python -m venv .venv
     # Windows
     .venv\Scripts\activate
     # Linux/Mac
     source .venv/bin/activate
     pip install --upgrade pip
     pip install -r requirements.txt
     ```

3. 가상환경 활성화:
   - Windows:
     ```
     activate_venv.bat
     ```
     또는
     ```
     .venv\Scripts\activate
     ```
   - Linux/Mac:
     ```
     source activate_venv.sh
     ```
     또는
     ```
     source .venv/bin/activate
     ```

4. API 키 설정:
   - `.env.example` 파일을 복사하여 `.env` 파일을 생성합니다:
   - `.env` 파일에 API 키를 추가합니다:
   ```
   GOOGLE_API_KEY=your_google_api_key
   PERPLEXITY_API_KEY=your_perplexity_api_key
   ```

## 사용 방법

1. 애플리케이션 실행:
   ```
   streamlit run app.py
   ```

2. 웹 브라우저에서 `http://localhost:8501` 접속

3. HWP/HWPX 파일 업로드:
   - "파일 업로드 및 분석" 탭에서 HWP 또는 HWPX 파일을 업로드합니다.
   - 여러 파일을 동시에 선택할 수 있습니다.

4. 파일 분석:
   - 업로드된 파일 목록에서 분석할 파일을 선택합니다.
   - "선택한 파일 분석하기" 버튼을 클릭합니다.
   - 분석이 완료되면 문서 구조, 메타데이터, 텍스트 내용, 표, 이미지 등을 확인할 수 있습니다.
   - 문서 타입이 자동으로 감지되어 맞춤형 분석 결과가 제공됩니다.

5. 데이터 추출:
   - "데이터 추출" 탭에서 분석된 파일을 선택합니다.
   - 텍스트, 표, 이미지 등 추출할 데이터 유형을 선택합니다.
   - 추출된 데이터를 다운로드할 수 있습니다.

6. 문서 변환:
   - "문서 변환" 탭에서 변환할 파일을 선택합니다.
   - 변환 형식(LaTeX, 마크다운 등)을 선택합니다.
   - 변환 옵션을 설정합니다.
   - "변환하기" 버튼을 클릭하여 문서를 변환합니다.
   - 변환된 결과를 확인하고 다운로드할 수 있습니다.

7. 문서 비교:
   - "문서 비교" 탭에서 두 개의 분석된 파일을 선택합니다.
   - "비교 분석하기" 버튼을 클릭하여 두 문서의 차이점과 유사점을 확인합니다.

8. 질의응답:
   - "질의응답" 탭에서 분석된 파일을 선택합니다.
   - 문서에 대한 질문을 입력하고 "질문하기" 버튼을 클릭합니다.
   - AI가 문서 내용을 기반으로 답변을 제공합니다.

9. 최신성 평가:
   - "최신성 평가" 탭에서 문서의 최신성을 평가할 수 있습니다.
   - 평가 결과를 바탕으로 업데이트가 필요한 부분에 대한 제안을 받을 수 있습니다.

## 고급 설정

- **분석 모드**: 사이드바에서 "상세 분석 모드"를 활성화하여 더 깊이 있는 분석과 통찰력을 얻을 수 있습니다.
- **하이브리드 검색**: 사이드바에서 "하이브리드 검색 사용"을 활성화하여 최신 웹 정보를 포함한 분석 결과를 얻을 수 있습니다.
- **변환 옵션**: 다양한 변환 옵션을 설정하여 원하는 형식과 스타일로 문서를 변환할 수 있습니다.
- **검증 라운드**: 분석 검증 라운드 수를 설정하여 분석 품질을 향상시킬 수 있습니다.
- **성능 모니터링**: 성능 지표 확인을 통해 API 호출 및 처리 성능을 모니터링할 수 있습니다.

## 최근 개선 사항

- **한국어 텍스트 처리 최적화**: 한국어 특성에 맞는 텍스트 분석 알고리즘 추가
- **문서 타입 자동 감지**: 국책과제, 법률, 논문 등 문서 타입 자동 감지 기능 추가
- **API 캐싱 시스템**: 중복 요청 최소화 및 처리 속도 향상을 위한 캐싱 시스템 구현
- **병렬 처리**: 대용량 문서 처리 성능 향상을 위한 병렬 처리 기능 추가
- **성능 메트릭 시스템**: API 호출 및 처리 성능 모니터링을 위한 지표 시스템 구현
- **적응형 타임아웃 및 재시도 로직**: API 호출 안정성 향상을 위한 재시도 로직 추가
- **문서 최신성 평가**: 문서 내용의 최신성을 평가하고 업데이트 제안 기능 추가

## 시스템 요구사항

- Python 3.8 이상
- Windows 운영체제 (HWP 파일 처리를 위한 최적 환경)
- 인터넷 연결 (API 호출 및 웹 검색을 위해 필요)
- 최소 4GB RAM

## 문제 해결

- **HWP/HWPX 파일 처리 오류**: pyhwpx 라이브러리가 특정 HWP/HWPX 파일을 처리하지 못하는 경우, 애플리케이션은 자동으로 대체 방법(win32com)을 시도합니다.
- **API 키 오류**: API 키가 올바르게 설정되었는지 확인하세요. 사이드바에서 직접 API 키를 입력할 수도 있습니다.
- **메모리 오류**: 매우 큰 HWP/HWPX 파일을 처리할 때 메모리 오류가 발생할 수 있습니다. 이 경우 더 작은 파일로 분할하거나 시스템 메모리를 늘리세요.
- **변환 오류**: 문서 변환 중 오류가 발생하면 "기본 템플릿 사용" 옵션을 선택하여 기본 템플릿으로 변환을 시도하세요.
- **캐시 관련 문제**: 캐시 파일에 문제가 있는 경우 `cache` 디렉토리를 삭제하고 재시작하세요.

## 기여 방법

1. 이 저장소를 포크합니다.
2. 새 기능 브랜치를 생성합니다 (`git checkout -b feature/amazing-feature`).
3. 변경사항을 커밋합니다 (`git commit -m 'Add some amazing feature'`).
4. 브랜치에 푸시합니다 (`git push origin feature/amazing-feature`).
5. Pull Request를 생성합니다.

## 라이선스

2025 유근빈 G.Bin-YU build So MIT License

## 연락처

문의사항이나 버그 리포트는 [ingeng2004@gmail.com](mailto:ingeng2004@gmail.com)으로 보내주세요.

## Streamlit Cloud 배포 가이드

이 프로젝트는 Streamlit Cloud에 최적화되어 있습니다. 다음 단계를 따라 배포하세요:

1. [Streamlit Cloud](https://streamlit.io/cloud)에 가입하고 로그인합니다.
2. "New app" 버튼을 클릭합니다.
3. GitHub 저장소를 연결하고 이 프로젝트의 저장소를 선택합니다.
4. 메인 파일 경로로 `app.py`를 지정합니다.
5. 고급 설정에서 Python 버전을 3.9 이상으로 설정합니다.
6. Secrets 섹션에서 다음 내용을 추가합니다:
   ```
   PERPLEXITY_API_KEY = "your-perplexity-api-key"
   GOOGLE_API_KEY = "your-google-api-key"
   PLATFORM = "linux"
   HWP_FEATURE_LIMITED = "true"
   ```
7. "Deploy!" 버튼을 클릭하여 배포를 시작합니다.

### 주의사항

- Streamlit Cloud는 Linux 환경에서 실행되므로, HWP 파일 처리 기능이 제한적입니다.
- 기본 텍스트 추출 및 메타데이터 분석은 가능하지만, 이미지 추출 및 고급 서식 분석은 지원되지 않습니다.
- 전체 기능을 사용하려면 Windows 환경에서 로컬로 실행하는 것이 좋습니다.

### 배포 문제 해결

배포 중 다음과 같은 문제가 발생할 수 있습니다:

1. **패키지 설치 오류**: Windows 전용 패키지(`pywin32`, `pyhwpx`)는 Linux 환경에서 설치되지 않습니다. `requirements.txt`에서 이러한 패키지는 제외되어 있습니다.

2. **한글 폰트 오류**: Linux 환경에서 한글 폰트가 없을 수 있습니다. 이 경우 기본 폰트로 대체됩니다.

3. **메모리 제한**: 대용량 파일 처리 시 메모리 제한에 도달할 수 있습니다. 이 경우 더 작은 파일로 분할하세요. 